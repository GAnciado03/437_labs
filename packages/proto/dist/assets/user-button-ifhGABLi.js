const d="theme";function n(){const t=document.body.classList.contains("dark");document.querySelectorAll("[data-theme-button]").forEach(e=>{e.setAttribute("aria-pressed",String(t));const o=e.getAttribute("data-label-on")||"Dark: On",i=e.getAttribute("data-label-off")||"Dark: Off";e.textContent=t?o:i})}function s(t){document.body.classList.toggle("dark",t==="dark"),n()}function c(){const t=localStorage.getItem(d);return t==="dark"||t==="light"?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function l(t){localStorage.setItem(d,t),s(t)}document.body.addEventListener("theme-toggle",()=>{const t=document.body.classList.contains("dark")?"light":"dark";l(t)});function a(){document.querySelectorAll("[data-theme-button]").forEach(t=>{t.addEventListener("click",()=>{document.body.dispatchEvent(new CustomEvent("theme-toggle",{bubbles:!0}))})})}s(c());document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{a(),n()}):(a(),n());function u(){try{return!!localStorage.getItem("token")}catch{return!1}}function r(){const t=(location.pathname||"").toLowerCase();if(t==="/"||t.endsWith("/index.html")||t.endsWith("index.html")||t.endsWith("/user.html")||t.endsWith("user.html")||document.querySelector("#floating-user-button"))return;const e=document.createElement("a");e.id="floating-user-button";const o=u();e.href=o?"user.html":"login.html",e.setAttribute("aria-label",o?"User":"Login"),e.className="mono",e.textContent=o?"User":"Login",Object.assign(e.style,{position:"fixed",top:"var(--space-3, 1rem)",right:"var(--space-3, 1rem)",padding:".35rem .6rem",background:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm, 6px)",textDecoration:"none",fontWeight:"600",boxShadow:"var(--shadow-sm, 0 1px 2px rgba(0,0,0,.08))",zIndex:"1000"}),document.body.appendChild(e)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r();
